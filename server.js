/* Example Node proxy */
const express=require('express'); const fetch=require('node-fetch'); const app=express(); app.use(express.json());
const OPENAI_KEY=process.env.OPENAI_API_KEY; if(!OPENAI_KEY){ console.error('Set OPENAI_API_KEY'); process.exit(1); }
app.post('/analyze', async (req,res)=>{ const text=req.body.text||''; if(!text) return res.status(400).json({error:'No text'}); try{ const payload={ model:'gpt-4o-mini', messages:[{role:'system',content:'You are a tone analysis assistant. Return JSON: { score: number -10..10, suggestions: [strings] }'},{role:'user',content:'Analyze this email and return only JSON: '+text}], max_tokens:200 }; const r=await fetch('https://api.openai.com/v1/chat/completions',{method:'POST',headers:{'Content-Type':'application/json','Authorization':'Bearer '+OPENAI_KEY},body:JSON.stringify(payload)}); const data=await r.json(); const content=data.choices?.[0]?.message?.content||''; try{ const parsed=JSON.parse(content); return res.json(parsed); }catch(e){ return res.json({score:0,suggestions:['Could not parse model response.']}); } }catch(err){ console.error(err); res.status(500).json({error:'server error'}); } }); const port=process.env.PORT||3000; app.listen(port,()=>console.log('Server started on',port));